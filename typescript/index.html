<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>TypeScript</title>

    <link rel="stylesheet" href="dist/reset.css" />
    <link rel="stylesheet" href="dist/reveal.css" />
    <link rel="stylesheet" href="dist/theme/serif.css" id="theme" />

    <!-- Theme used for syntax highlighted code -->
    <link
      rel="stylesheet"
      href="plugin/highlight/tomorrow.css"
      id="highlight-theme"
    />
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <h1>TypeScript</h1>
        </section>

        <section>
          <h2>C'est quoi TypeScript ?</h2>
          <blockquote>
            TypeScript is <br />
            a <strong>typed superset</strong> of <strong>JavaScript</strong
            ><br />
            that compiles to
            <strong>plain JavaScript</strong>.
          </blockquote>
        </section>

        <section>
          <h3>En JavaScript</h3>
          <section>
            <pre><code data-trim data-noescape data-line-numbers="1-3|5|7" class="javascript">
function greeter(person) {
  return "Hello, " + person;
}

greeter('Michel');

// Hello, Michel
</code></pre>
          </section>

          <section>
            <pre><code data-trim data-noescape data-line-numbers="5|7" class="javascript">
function greeter(person) {
  return "Hello, " + person;
}

greeter({ firstname: 'Michel', lastname: 'Michel' });

// Hello, [object Object]
</code></pre>
          </section>
        </section>

        <section>
          <h3>En TypeScript</h3>

          <section>
            <p>
              On ajoute le typage (<strong>Type</strong>Script)
            </p>
            <pre><code data-trim data-noescape data-line-numbers="1-3|5|7" class="typescript">
function greeter(person: string) {
  return "Hello, " + person;
}

greeter('Michel');

// Hello, Michel
</code></pre>
          </section>

          <section>
            <pre><code data-trim data-noescape data-line-numbers="5|7-8" class="typescript">
function greeter(person: string) {
  return "Hello, " + person;
}

greeter({ firstname: 'Michel', lastname: 'Michel' });

// Argument of type '{ firstname: string; lastname: string; }'
// is not assignable to parameter of type 'string'.
</code></pre>
          </section>

          <section>
            <p>
              Attention !
            </p>
            <p>
              Le code compil√© reste du JavaScript "classique".
            </p>

            <pre><code data-trim data-noescape class="javascript">
function greeter(person) {
  return "Hello, " + person;
}

greeter('Michel');
</code></pre>
          </section>
          <section>
            <div>On peut aussi typer les retours de fonction :</div>
            <pre><code data-trim data-noescape class="typescript">
function nbLetter(str: string): number {
  return str.length;
}
	</code></pre>

            <div>et des fonction fl√©ch√©es :</div>
            <pre><code data-trim data-noescape class="typescript">
const nbLetter = (str: string): number => str.length;
</code></pre>
          </section>
        </section>

        <section>
          <blockquote>TypeScript, c'est PHPStan pour JavaScript</blockquote>
        </section>

        <section>
          <h2>Les types "basiques"</h2>

          <section data-markdown>
            <textarea data-template>
			  Bool√©ens:

			  ```typescript
			  let isActive: boolean = true;
			  ```
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
			  Nombres

			  ```typescript
			  let n: number = 8;
			  ```
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
				Chaines de caract√®res

				```typescript
				let name: string = 'Michel';
				```
			</textarea
            >
          </section>

          <section>
            Tableaux
            <pre><code data-trim data-noescape class="typescript">				
				let list: number[] = [1, 2, 3]; 
			</code></pre>
            ou alors la forme plus explicite :

            <pre><code data-trim data-noescape class="typescript">
				let list: Array&lt;number&gt; = [1, 2, 3];
			</code></pre>
          </section>

          <section data-markdown>
            <textarea data-template>
				Tuples

				Tableaux typ√©s de longueur fixe

				```typescript
				// Declare a tuple type
				let x: [string, number];

				// Initialize it
				x = ["hello", 10]; // OK

				// Initialize it incorrectly
				x = [10, "hello"]; // Error
				```

				x[0] sera bien reconnu comme `string`
				
				et x[1] comme `number`
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
				Enum

				```typescript
				enum Color { Red, Green, Blue }
				let c: Color = Color.Green;
				```
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
				"any"

				```typescript
				let notSure: any = 4;
				notSure = "maybe a string instead";
				notSure = false; // okay, definitely a boolean
				```

				A √©viter au maximum. Permet √©ventuellement la transformation JS ‚Üí TS progressive
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
				void

				```typescript
				function warnUser(): void {
				  console.log("This is my warning message");
				}
				```
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
				null et undefined

				```typescript
				// Not much else we can assign to these variables!
				let u: undefined = undefined;
				let n: null = null;
				```
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
				never

				Repr√©sente quelque chose qui ne doit jamais arriver.

				```typescript
				// Function returning never must have unreachable end point
				function error(message: string): never {
				  throw new Error(message);
				}
				```
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
				object

				```typescript
				declare function create(o: object | null): void;

				create({ prop: 0 }); // OK
				create(null); // OK

				create(42); // Error
				create("string"); // Error
				create(false); // Error
				create(undefined); // Error
				```
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
				conversion de type

				
				```typescript
				let someValue: any = "this is a string";
				
				let strLength: number = (someValue as string).length;
				```

				Fa√ßon de dire au compilateur :
				
				"Ne t'inqui√®tes pas, je sais ce que je fais."
			</textarea
            >
          </section>
        </section>

        <section>
          <h2>Un peu de POO</h2>
        </section>

        <section>
          <h3>Les interfaces</h3>

          <section>
            <ul>
              <li>Pas d'interfaces en JavaScript</li>
              <li>TypeScript v√©rifie la "forme" des objets</li>
              <li>
                En TypeScript, les interface permettent juste de nommer une
                "forme"
              </li>
            </ul>

            <aside class="notes">
              Ce qui change totallement du PHP, et qui m'a vraiment pos√©
              probl√®mes parfois, mon esprit √©tant trop habitu√© aux autres
              languages objets
            </aside>
          </section>

          <section>
            <pre><code data-trim data-noescape data-line-numbers="1-2|5-6" class="typescript">
				function printLabel(labeledObj: { label: string }) {
				  console.log(labeledObj.label);
				}
				
				let myObj = {size: 10, label: "Size 10 Object"};
				printLabel(myObj);
			</code></pre>

            <div class="fragment">
              <p>üëç</p>
              <p>"myObj" a bien une cl√© "label" de type "string"</p>
            </div>
          </section>

          <section>
            On peut extraire la d√©finition de "l'interface"
            <pre><code data-trim data-noescape data-line-numbers="1-5" class="typescript">
				interface LabeledValue {
					label: string;
				}
				
				function printLabel(labeledObj: LabeledValue) {
					console.log(labeledObj.label);
				}
				
				let myObj = {size: 10, label: "Size 10 Object"};
				printLabel(myObj);
			</code></pre>

            <aside class="notes">
              Pas besoin de d√©finir que `myObj` impl√©mente l'interface
              contrairement au PHP, du moment que sa "forme" est un sur-ensemble
              de la valeur attendue
            </aside>
          </section>

          <section data-markdown>
            <textarea data-template>
				Propri√©t√©s optionnelles

				```typescript
				interface SquareConfig {
				  width?: number;
				}
				
				function createSquare(config: SquareConfig): {area: number} {
				  let newSquare = { area: 100 };
				  if (config.width) {
				    newSquare.area = config.width * config.width;
				  }
				  return newSquare;
				}
				
				let mySquare = createSquare({});
				```
			</textarea
            >
          </section>

          <section data-markdown>
            <textarea data-template>
				readonly

				```typescript
				interface Point {
				  readonly x: number;
				  readonly y: number;
				}
				```

				```typescript
				let p1: Point = { x: 10, y: 20 };
				p1.x = 5; // error!
				```

				√âquivalent de "const" pour les propri√©t√©s
			</textarea
            >

            <aside class="notes">
              Surement assez puissant, je ne m'en suis jamais servi cela dit
            </aside>
          </section>

          <section>
            <h3>Les classes</h3>

            <p>
              Une classe peut iml√©menter une interface
            </p>

            <pre><code data-trim data-noescape class="typescript" data-line-numbers="1-4|6-14">
			interface ClockInterface {
			  currentTime: Date;
			  setTime(d: Date): void;
			}
			
			class Clock implements ClockInterface {
			  currentTime: Date = new Date();

			  constructor(h: number, m: number) { }

			  setTime(d: Date) {
			    this.currentTime = d;
			  }
			}
			</code></pre>
          </section>
        </section>

        <section>
          <h3>private, protected, public</h3>

          <section>
            <pre><code data-trim data-noescape class="typescript">
		    class Human {
				// public par d√©faut
				firstname: string;
				// idem
				public lastname: string;

				// accessible aux enfants, mais en JS √ßa reste public
				protected religion: string;

				// accessible √† personne, mais en JS √ßa reste public, √† √©viter
				private sex: string;
				// fonctionnalit√© ECMAScript, vraiment priv√©, √† privil√©gier
				#salary: number;
			}
			</code></pre>
          </section>

          <section></section>
        </section>

        <section>
          <h2>Les fonctions</h2>

          <section>
            En JavaScript, les param√®tres de fonctions sont tous facultatifs:

            <pre><code data-trim data-noescape class="javascript">
			  function buildName(firstName, lastName) {
			    console.log(firstName, lastName);
			  }

			  buildName(); // log : undefined, undefined
			  </code></pre>
          </section>

          <section>
            En TypeScript, tous les param√®tres sont requis, sauf si ils sont
            not√©s comme facultatifs:
            <pre><code data-trim data-noescape class="javascript">
			  function buildName(firstName: string, lastName?: string) {
			    console.log(firstName, lastName);
			  }
  
			  buildName(); // Erreur
			  buildName('Michel'); // OK, log: Michel, undefined
			  buildName('Michel', 'Michel'); // OK
			  buildName('Michel', 'Michel', 'Michel'); // Erreur
			  </code></pre>
          </section>

          <section>
            Une interface peut d√©finir une fonction:

            <pre><code data-trim data-noescape class="typescript" data-line-numbers="1-3|5|6-9">
			interface SearchFunc {
			  (source: string, subString: string): boolean;
			}
			
			let mySearch: SearchFunc;
			mySearch = function(source: string, subString: string): boolean {
			  let result = source.search(subString);
			  return result > -1;
			}

			function callMe(fn: SearchFunc) {
			  // ...
			}
			</code></pre>

            <aside class="notes">
              JavaScript, le language de la fonction : callback, promises,
              √©v√®nements, etc.
            </aside>
          </section>

          <section>
            On peut aussi les d√©finir "inline

            <pre><code data-trim data-noescape class="typescript" data-line-numbers="1-3|5|6-9">
			let mySearch = function(source: string, subString: string): boolean {
			  let result = source.search(subString);
			  return result > -1;
			}

			function callMe(fn: (source: string, subString: string) => boolean) {
			  // ...
			}
			</code></pre>

            <aside class="notes">
              Mais c'est tr√®s vite illisible, √ßa va bien pour "bootstraper".
              Notez les `:` qui se "transforment en fl√®che.
            </aside>
          </section>

          <section>
            <h3>Retours dynamiques de fonctions</h3>
            <pre><code data-trim data-noescape class="typescript" data-line-numbers="3-9|1-2">
function doWeirdStuff(x: number): number;
function doWeirdStuff(x: string): boolean;
function doWeirdStuff(x): any {
  if (typeof x === 'number') {
    return x * 2;
  }

  return x.length > 3;
}

let n = doWeirdStuff(8); // n est de type "number"
let b = doWeirdStuff('this is weird'); // n est de type "boolean"
</code></pre>

            <aside class="notes">
              On peut typer dynamiquement le retour des fonction en fonction de
              ses param√®tres en entr√©e.
            </aside>
          </section>
		</section>
		
		<section>
			J'en suis l√† :
			<a href="https://www.typescriptlang.org/docs/handbook/generics.html" target="_blank" type="noopener noreferer">
				Les g√©n√©riques
			</a>
      </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
      });
    </script>
  </body>
</html>
